(self.webpackChunk=self.webpackChunk||[]).push([[781],{37031:function(Pe,q,e){"use strict";e.d(q,{jJ:function(){return M},ND:function(){return D},bz:function(){return ce},ax:function(){return ee}});var Y=e(62435),f={wrapList:"wrapList___xBToW",active:"active___N9m6c",personName:"personName___Nzqy1"},g=e(86074),R=function(c){var T=c.list,j=c.handleProps,L=[{src:"https://randomuser.me/api/portraits/women/95.jpg",name:"Van Dort"},{src:"https://randomuser.me/api/portraits/men/11.jpg",name:"Naik"},{src:"https://randomuser.me/api/portraits/men/41.jpg",name:"Perrin"},{src:"https://randomuser.me/api/portraits/men/34.jpg",name:"Romero"},{src:"https://randomuser.me/api/portraits/women/40.jpg",name:"Manzanare"}],m=function(a){console.log(a,999),j(a)};return(0,g.jsx)("div",{className:f.wrapList,children:T.map(function(v,a){var o;return(0,g.jsxs)("p",{onClick:function(){return m(v)},children:[(0,g.jsx)("img",{src:v.src?v.src:(o=L[a%5])===null||o===void 0?void 0:o.src}),(0,g.jsx)("span",{className:f.personName,children:v.role})]},v.role+a)})})},M=R,O=e(19632),_=e.n(O),V=e(5574),le=e.n(V),h=function(c){var T=c.list,j=c.handleProps,L=(0,Y.useState)([]),m=le()(L,2),v=m[0],a=m[1],o=[{src:"https://www.stratosphere.io/assets/images/search/logos/AAPL.svg",name:"Apple Inc."},{src:"https://www.stratosphere.io/assets/images/search/logos/2222.SR.svg",name:"Saudi Arabian Oil Company"},{src:"https://www.stratosphere.io/assets/images/search/logos/MSFT.svg",name:"Microsoft Corporation"},{src:"https://www.stratosphere.io/assets/images/search/logos/AMZN.svg",name:"Amazon.com, Inc."},{src:"https://www.stratosphere.io/assets/images/search/logos/TSLA.svg",name:"Tesla, Inc."}],s=function(p){var n=_()(v),x=n.findIndex(function(z){return z.company===p.company});x!==-1?n.splice(x,1):n.push(p),a(n),j(n)};return(0,g.jsx)("div",{className:f.wrapList,children:T.map(function(r,p){var n;return(0,g.jsxs)("p",{className:v.some(function(x){return x.company===r.company})?f.active:"",onClick:function(){return s(r)},children:[(0,g.jsx)("img",{src:r.src?r.src:(n=o[p%5])===null||n===void 0?void 0:n.src}),r.company]},r.company+p)})})},D=h,ie=function(c){var T=c.list,j=c.handleProps,L=function(v){console.log(v,999),j(v)};return(0,g.jsx)("div",{className:f.wrapList,children:T.map(function(m,v){return(0,g.jsx)("p",{onClick:function(){return L(m)},children:(0,g.jsx)("span",{className:f.personName,children:m})},m+v)})})},ee=ie,ue=e(79011);function fe(U){var c=U.chartData;console.log(c,123);var T=(0,Y.useRef)(null);return(0,Y.useEffect)(function(){console.log(c,12312);var j=ue.init(T.current),L={title:{text:"ECharts \u793A\u4F8B\u56FE\u8868"},xAxis:{type:"category",data:["A","B","C","D","E"]},yAxis:{type:"value"},series:[{name:"\u793A\u4F8B\u6570\u636E",type:"bar",data:[5,10,15,20,25]}]};return j.setOption(L),function(){j.dispose()}},[c]),(0,g.jsx)("div",{ref:T,style:{width:"100%",height:"400px"}})}var ce=fe,W=function(){var c=["Racing car sprays burning fuel into crowd.","Japanese princess to wed commoner.","Australian walks 100km after outback crash.","Man charged over missing wedding girl.","Los Angeles battles huge wildfires."];return _jsx(List,{size:"small",bordered:!0,dataSource:c,renderItem:function(j){return _jsxs(List.Item,{children:[j,_jsx(EditOutlined,{style:{margin:"0 0 0 8px"}})]})}})},de=null},69309:function(Pe,q,e){"use strict";e.r(q),e.d(q,{default:function(){return ye}});var Y=e(97857),f=e.n(Y),g=e(19632),R=e.n(g),M=e(15009),O=e.n(M),_=e(99289),V=e.n(_),le=e(5574),h=e.n(le),D=e(90489),ie=e(13923),ee=e(51042),ue=e(51767),fe=e(87547),ce=e(61462),W=e(48141),de=e(66284),U=e(96365),c=e(80254),T=e(83097),j=e(84908),L=e(71577),m=e(83134),v=e(55241),a=e(59652),o=e(96486),s=e.n(o),r=e(62435),p=e(37031),n={wrapFinchat:"wrapFinchat___uJSqV",left:"left___ClisR","scrollable-div":"scrollable-div___K8dJN",wrapHistory:"wrapHistory___VS35q",right:"right___cHUu1",wrapCopy:"wrapCopy___MAuYS",content:"content___wWCUv",user:"user___xwzh2",tag:"tag___Ds8pw",cursor:"cursor___iSKKw",blink:"blink___gycRl",wrapTxt:"wrapTxt___uyS6i",top:"top___aa8Fe",bottom:"bottom___eC__6"},x=e(52677),z=e.n(x),K=function(i){var B=(0,W.useModel)("@@initialState"),H=B.initialState.currentUser;console.log(H);var Se=(0,r.useState)(null),se=h()(Se,2),re=se[0],Te=se[1],Ce=(0,r.useState)([]),Z=h()(Ce,2),ve=Z[0],he=Z[1];(0,r.useEffect)(function(){var E=new WebSocket(i);return E.onopen=function(){console.log("WebSocket connection established.")},E.onmessage=function(w){var A,F;console.log(w,99);var $=JSON.parse(w.data||"{}"),Q=(A=$.output)===null||A===void 0?void 0:A.answer;Q=Q.replace(/\n/g,"<br>");var b=(F=$.output)===null||F===void 0?void 0:F.chart;z()(b)==="object"&&Object.keys(b).length===0&&(b=null),he(function(Ae){var Ne=R()(Ae).map(function(Re){return f()(f()({},Re),{},{flag:!1})});return[].concat(R()(Ne),[{sender:"bot",content:Q,chart:b}])})},E.onerror=function(w){console.error("WebSocket error:",w)},E.onclose=function(){console.log("WebSocket connection closed.")},Te(E),function(){E.close()}},[i]);var je=function(){he([])},xe=function(w,A){if(he(function(b){return[].concat(R()(b),[{sender:"user",content:w,flag:!0}])}),re&&re.readyState===WebSocket.OPEN){var F,$,Q={header:{user:H.username,token:H.token,req_id:H.id,req_src:H.avatarUrl},data:{role:A.role,input:w,company:((F=A.company)===null||F===void 0?void 0:F.length)>1?A.company.map(function(b){return b.company}):($=A.company[0])===null||$===void 0?void 0:$.company,task:A.task,session_id:H.id+H.username}};re.send(JSON.stringify(Q))}};return{message:ve,sendWebSocketMessage:xe,clearMessage:je}},te=K,t=e(86074),ae=U.Z.Search,ge=c.Z.Text,k=function(){var i=(0,W.useModel)("@@initialState"),B=i.initialState.currentUser,H=(0,r.useState)(""),Se=h()(H,2),se=Se[0],re=Se[1],Te=(0,r.useState)("a"),Ce=h()(Te,2),Z=Ce[0],ve=Ce[1],he=(0,r.useState)([]),je=h()(he,2),xe=je[0],E=je[1],w=(0,r.useState)([]),A=h()(w,2),F=A[0],$=A[1],Q=(0,r.useState)([]),b=h()(Q,2),Ae=b[0],Ne=b[1],Re=(0,r.useState)([]),Oe=h()(Re,2),Ue=Oe[0],pe=Oe[1],Je=(0,r.useState)([]),Ie=h()(Je,2),ne=Ie[0],Ge=Ie[1],Ye=(0,r.useState)(null),He=h()(Ye,2),oe=He[0],Ve=He[1],Ke=(0,r.useState)(null),Ze=h()(Ke,2),ke=Ze[0],Qe=Ze[1],Xe=(0,r.useState)([]),we=h()(Xe,2),Fe=we[0],qe=we[1],Ee=te("ws://121.37.5.77:5004"),Le=Ee.message,_e=Ee.sendWebSocketMessage,et=Ee.clearMessage,tt=(0,r.useState)(Le),De=h()(tt,2),We=De[0],ze=De[1],be={user:B.username,req_id:B.id,req_src:B.avatarUrl,token:B.token},at=function(u){re(u.target.value)},st=function(){var l=V()(O()().mark(function u(){var y,S,N,J,I,d,C,me,X,G;return O()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.prev=0,P.next=3,D.Np.fetchSidebar({header:be});case 3:y=P.sent,S=y.output||{},N=S.history_list,J=N===void 0?[]:N,I=S.role_list,d=I===void 0?[]:I,C=S.task_list,me=C===void 0?[]:C,X=S.stock_list,G=X===void 0?[]:X,E(J),$(d),qe(G),pe(G),Ne(me),console.log(y,"res"),P.next=16;break;case 13:P.prev=13,P.t0=P.catch(0),console.log(P.t0,"error");case 16:case"end":return P.stop()}},u,null,[[0,13]])}));return function(){return l.apply(this,arguments)}}(),rt=function(){var l=V()(O()().mark(function u(){var y,S,N,J,I;return O()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.prev=0,C.next=3,D.Np.fetchHistoryList({header:be,data:{session_id:B.id+B.username}});case 3:S=C.sent,N=S.output,N!=null&&(y=N.result)!==null&&y!==void 0&&y.length&&(J=N.result,I=[],J.forEach(function(me){var X;console.log(JSON.parse(me));var G=JSON.parse(me);I.push({sender:"user",content:G.input}),I.push({sender:"bot",content:G.output,chartData:(X=G.chartData)!==null&&X!==void 0&&X.type?G.chartData:null})}),E(I),ze(I)),console.log(S,"res"),C.next=12;break;case 9:C.prev=9,C.t0=C.catch(0),console.log(C.t0,"error");case 12:case"end":return C.stop()}},u,null,[[0,9]])}));return function(){return l.apply(this,arguments)}}();(0,r.useEffect)(function(){st()},[]),(0,r.useEffect)(function(){ze([].concat(R()(xe),R()(Le)))},[Le]);var nt=function(){var l=V()(O()().mark(function u(y){var S,N,J;return O()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(d.prev=0,y){d.next=4;break}return pe(Fe),d.abrupt("return");case 4:return d.next=6,D.Np.queryCompany({header:be,data:{query:y}});case 6:N=d.sent,J=((S=N.output)===null||S===void 0?void 0:S.result)||[],pe(J),d.next=14;break;case 11:d.prev=11,d.t0=d.catch(0),T.ZP.error(d.t0===null||d.t0===void 0?void 0:d.t0.msg);case 14:case"end":return d.stop()}},u,null,[[0,11]])}));return function(y){return l.apply(this,arguments)}}(),ot=s().debounce(function(l){var u=l.target.value;if(!u){pe(Fe);return}var y=Ue.filter(function(S){return S.company.indexOf(u)!==-1});pe(y)},1e3),Be=function(){se&&(_e(se,f()(f()({company:ne},oe),{},{task:ke})),re(""))},lt=function(u){var y=u.target.value;ve(y)},it=function(u){Ve(u),et()},ut=function(u){ke!=="compare"&&ve("c"),Ge(u)},ct=function(u){Qe(u),ve("b")},dt=function(){sessionStorage.setItem("content",JSON.stringify(Le)),W.history.push({pathname:"/user/user/content"})},vt=(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(j.Z,{placement:"top",title:"\u5386\u53F2\u8BB0\u5F55",children:(0,t.jsx)(ie.Z,{onClick:rt,style:{margin:"0 0 0 12px",fontSize:"16px"}})})}),$e=!(ke||ne||oe);return console.log(We,"messageList"),(0,t.jsxs)("div",{className:n.wrapFinchat,children:[(0,t.jsxs)("div",{className:n.left,children:[(0,t.jsx)(L.Z,{style:{width:"80%",marginTop:"12px"},icon:(0,t.jsx)(ee.Z,{}),children:"New Chat"}),(0,t.jsxs)(m.ZP.Group,{defaultValue:Z,value:Z,buttonStyle:"solid",onChange:lt,children:[(0,t.jsx)(m.ZP.Button,{value:"a",children:"Task"}),(0,t.jsx)(m.ZP.Button,{value:"b",children:"Companies"}),(0,t.jsx)(m.ZP.Button,{value:"c",children:"Roles"})]}),Z==="b"&&(0,t.jsx)(ae,{placeholder:"Search by name or ticker",allowClear:!0,onSearch:nt,onChange:ot,style:{width:"80%",margin:"0 0 12px 0"}}),Z==="a"&&(0,t.jsx)(p.ax,{list:Ae,handleProps:ct}),Z==="b"&&(0,t.jsx)(p.ND,{list:Ue,handleProps:ut}),Z==="c"&&(0,t.jsx)(p.jJ,{list:F,handleProps:it})]}),(0,t.jsxs)("div",{className:n.right,children:[(0,t.jsx)("div",{className:n.wrapCopy,children:(0,t.jsx)(v.Z,{content:"\u4E00\u952E\u53D1\u5E03\u5F53\u524D\u804A\u5929\u5185\u5BB9",trigger:"hover",children:(0,t.jsx)(ue.Z,{style:{fontSize:18,cursor:"pointer",zIndex:999},onClick:dt})})}),(0,t.jsxs)("div",{className:n.content,children:[(oe==null?void 0:oe.role)&&(0,t.jsx)("div",{className:n.user,children:(0,t.jsxs)(a.Z,{style:{width:300},children:["hello\uFF01my name is ".concat(oe.role,", ").concat(ne!=null&&ne.length?"\u4F60\u9009\u62E9\u4E86".concat(ne.map(function(l){return l.company}).join("\u3001")):"",", \u8BF7\u8F93\u5165\u60A8\u8981\u54A8\u8BE2\u7684\u95EE\u9898?"),vt]})}),We.map(function(l,u){return l.sender==="user"?(0,t.jsx)("div",{className:n.user,children:(0,t.jsxs)(a.Z,{style:{width:300},children:[l.content&&(0,t.jsx)("div",{style:{padding:"0 16px 0 0"},dangerouslySetInnerHTML:{__html:l.content}}),l.flag&&(0,t.jsx)("span",{className:n.cursor}),(0,t.jsx)("span",{className:n.tag,children:(0,t.jsx)(fe.Z,{style:{fontSize:"18px"}})})]})},u):(0,t.jsx)("div",{className:n.user,children:(0,t.jsxs)(a.Z,{style:{width:300},children:[l.chart&&(0,t.jsx)(de.Z,{option:l.chart,style:{height:"300px"}}),l.content&&(0,t.jsx)("div",{style:{padding:"0 16px 0 0"},dangerouslySetInnerHTML:{__html:l.content}}),l.chartData?(0,t.jsx)(p.bz,{data:l.chartData}):null,(0,t.jsx)("span",{className:n.tag,children:(0,t.jsx)(ce.Z,{style:{fontSize:"18px"}})})]})},u)})]}),(0,t.jsxs)("div",{className:n.wrapTxt,children:[(0,t.jsxs)("div",{className:n.top,children:[(0,t.jsx)(L.Z,{children:"Regenerate"}),(0,t.jsx)(L.Z,{icon:(0,t.jsx)(ee.Z,{}),style:{margin:"0 0 0 20px"},children:"New Chat"})]}),(0,t.jsxs)("div",{className:n.bottom,children:[(0,t.jsx)(U.Z,{placeholder:"Send a message",allowClear:!0,disabled:$e,value:se,onPressEnter:Be,onChange:at}),(0,t.jsx)(L.Z,{type:"primary",onClick:Be,disabled:$e,children:"send"})]})]})]})]})},ye=k},90489:function(Pe,q,e){"use strict";e.d(q,{Np:function(){return j},Jf:function(){return m},cX:function(){return v}});var Y=e(12444),f=e.n(Y),g=e(72004),R=e.n(g),M={GET_CAPTCHA:"/getCaptcha",MODEL:"/category",LOGIN:"/login",SIDEBAR:"/sidebar",HISTORY:"/history",CREATE_ARTICLE:"/article/createArticle",QUERY_COMPANY:"/search"},O=e(15009),_=e.n(O),V=e(99289),le=e.n(V),h=e(9669),D=e.n(h),ie=e(80129),ee=e.n(ie),ue=D().CancelToken,fe=ue.source(),ce={baseURL:"http://121.37.5.77:5005/api",timeout:1e3*60*5,retry:0,retryDelay:1e3,paramsSerializer:function(o){return ee().stringify(o)}},W=D().create(ce);W.interceptors.request.use(function(a){return a}),W.interceptors.response.use(function(a){return a},function(a){return a.message.includes("timeout"),Promise.reject(a)});var de=!1,U=function(){var a=le()(_()().mark(function o(s){var r,p,n,x,z,K,te,t,ae,ge,k,ye;return _()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=s.baseURL,p=s.headers,n=p===void 0?{}:p,x=s.url,z=s.method,K=s.data,te=K===void 0?{}:K,t=s.params,ae=s.responseType,i.prev=1,i.next=4,W({baseURL:r,headers:n,url:x,method:z,data:te,params:t,responseType:ae});case 4:if(ge=i.sent,ge.status!==200){i.next=17;break}if(k=ge.data,typeof k!="string"){i.next=9;break}return i.abrupt("return",k);case 9:if(!(k.ret_code===0||k.code===200||k.code===0)){i.next=13;break}return i.abrupt("return",Promise.resolve(k));case 13:return console.log(k,"resp"),i.abrupt("return",Promise.reject(k));case 15:i.next=19;break;case 17:return ye={message:"\u670D\u52A1\u5668\u5F00\u5C0F\u5DEE~\u8BF7\u7A0D\u540E\u518D\u8BD5",code:-1},i.abrupt("return",Promise.reject(ye));case 19:i.next=27;break;case 21:if(i.prev=21,i.t0=i.catch(1),console.log(i.t0),!de){i.next=26;break}return i.abrupt("return");case 26:de=!0;case 27:case"end":return i.stop()}},o,null,[[1,21]])}));return function(s){return a.apply(this,arguments)}}(),c=function(o){var s=o.baseURL,r=s===void 0?"http://121.37.5.77:5005/api":s,p=o.method,n=p===void 0?"GET":p,x=o.url,z=o.data,K=o.params,te=o.responseType,t=o.headers,ae=t===void 0?{"Content-Type":"application/json"}:t;return U({baseURL:r,method:n,url:x,data:z,params:K,responseType:te,headers:ae})},T=null,j=function(){function a(){f()(this,a)}return R()(a,null,[{key:"fetchSidebar",value:function(s){return c({method:"POST",url:M.SIDEBAR,data:s})}},{key:"fetchHistoryList",value:function(s){return c({method:"POST",url:M.HISTORY,data:s})}},{key:"queryCompany",value:function(s){return c({method:"POST",url:M.QUERY_COMPANY,data:s})}}]),a}(),L=null,m=function(){function a(){f()(this,a)}return R()(a,null,[{key:"getCaptcha",value:function(s){return c({url:M.GET_CAPTCHA,params:s,baseURL:"http://39.101.71.109/app-api"})}},{key:"login",value:function(s){return c({method:"POST",url:M.LOGIN,data:s,baseURL:"http://39.101.71.109/app-api"})}}]),a}(),v=function(){function a(){f()(this,a)}return R()(a,null,[{key:"createArticle",value:function(s){return c({method:"POST",url:M.CREATE_ARTICLE,data:s})}}]),a}()},24654:function(){}}]);
